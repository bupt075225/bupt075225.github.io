磁盘镜像文件有raw和qcow2两种格式，在创建时可以选择空间分配三种模式：精简，厚置备置零，厚置备延迟置零。

raw精简模式，创建文件, 但不预分配空间，写数据时才分配

raw厚置备置零模式，分配空间并置零

raw厚置备延迟置零模式，分配空间但不置零，保留原始数据，第一次写时才初始化为零

qcow2精简模式，创建文件，预分配元数据

qcow2厚置备置零模式，预分配元数据，分配空间并置零

qcow2厚置备延迟置零模式，预分配元数据，分配空间但不置零，保留原始数据，第一次写时才初始化为零

qemu-img命令创建raw和qcow2两种格式的镜像文件，它们都有preallocation这个空间预分配模式选项，raw格式支持off,falloc,full，falloc预分配空间但不置0，full预分配空间且置0；qcow2格式支持off,metadata,falloc,full。

libvirt在存储池中创建存储卷，在storage driver中定义了storageVolCreateXML()接口，storage backend中实现createVol和buildVol两个接口，前者根据XML创建卷对象，后者执行文件创建。libvirt上游的buildVol接口创建raw格式的镜像文件时，只支持falloc模式，即厚置备延迟置零。

ocfs2在file operation中定义了fallocate接口.